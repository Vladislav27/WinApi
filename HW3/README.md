1. Создайте отдельный проект для сборки Dll.
2. Реализуйте в Dll экспортируемую функцию int PalindromeCounter( const wchar_t* text ) для вычисления количества палиндромов в тексте.
Указание. Объявите функцию в отдельном заголовочном файле. Используйте v__declspec( dllexport ) для указания того, что функция экспортируемая.
3. Реализуйте exe-модуль, принимающий в качестве аргумента из командной строки путь к файлу с текстом. Программа должна вызвать импортируемую функцию PalindromeCounter. Вычисленное количество слов показывайте в MessageBox.
Указание. Импортируемая функция должна быть объявлена с __declspec( dllimport ) в том же заголовочном файле. Для того, чтобы один заголовочный файл содержал объявление dllimport и dllexport, используйте макросы:
MYAPI int PalindromeCounter( const wchar_t* text );
Макрос MYAPI может по-разному раскрываться при подключении в разные проекты.
Для разрешения зависимости в настройках линкера укажите на необходимость загружать нужную dll в load-time. Или используйте #pragma comment( lib, … )
4. Сделайте вторую версию exe-модуля, в котором функцию PalindromeCounter вызывайте динамически.
Указание. Для загрузки dll используйте функцию LoadLibrary. Для получения указателя на нужную функцию – GetProcAddress.
5. Реализуйте статическую библиотеку кода (.lib), в которой реализуйте тот же функционал (PalindromeCounter).
6. Напишите третью версию exe-модуля, линкующегося со статической библиотекой. Для этого в настройках линкера (General->Additional Library Directories) укажите путь к lib файлу, в настройках компилятора (General->Additional Include Directories) укажите путь к .h файлам.
Для непосредственной линковки используйте либо Linker->Input->Additional Dependecies, либо во всех .h файлы, принадлежащие библиотечке подключите заголовочный файл “PalindromeCounterLibrary.h”, где необходимо прописать:
#pragma comment( lib, имя библиотеки )
